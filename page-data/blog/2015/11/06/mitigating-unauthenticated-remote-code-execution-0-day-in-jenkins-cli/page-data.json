{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2015/11/06/mitigating-unauthenticated-remote-code-execution-0-day-in-jenkins-cli/",
    "result": {"data":{"blog":{"html":"<div class=\"paragraph\">\n<p><strong>Updated 2015-11-11 15:00 UTC:</strong> We have released Jenkins 1.638 and 1.625.2 which contain a fix for this vulnerability. <a href=\"/security/advisory/2015-11-11/\">See the security advisory for more information about these releases</a>.</p>\n</div>\n<hr>\n<div class=\"paragraph\">\n<p><strong>Updated 2015-11-06 03:55 UTC:</strong> Included a updated mitigation script which doesn&#8217;t have a Jenkins boot race condition</p>\n</div>\n<hr>\n<div class=\"paragraph\">\n<p>Earlier today we received numerous reports about a previously undisclosed \"<a href=\"https://en.wikipedia.org/wiki/Zero-day_%28computing%29\">zero day</a>\" critical remote code execution vulnerability and exploit in Jenkins core. Unfortunately the vulnerability was not disclosed to us ahead of its publication so we&#8217;re still working on more thorough fix. In the <em>meantime</em> however, we wanted to inform you of the issue and provide a workaround which will help prevent this exploit from being used against public Jenkins installations, for future reference this issue is being tracked privately as <code>SECURITY-218</code> in our <a href=\"https://issues.jenkins.io\">issue tracker</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>The attack is mounted through the <a href=\"https://wiki.jenkins.io/display/JENKINS/Jenkins+CLI\">Jenkins CLI</a> subsystem, so the work-around is to remove/disable the CLI support inside of the running Jenkins server.</p>\n</div>\n<div class=\"paragraph\">\n<p>Using the following Groovy script you can disable the attack vector in your Jenkins installations by navigating to &#8220;Manage Jenkins&#8221; and then to &#8220;Script Console&#8221;, or just go to <code>https://your-jenkins-installation/script</code>. This only addresses the current running Jenkins process, in order to make the workaround persist between restarts of the Jenkins server, add the script below to <code>$JENKINS_HOME/init.groovy.d/cli-shutdown.groovy</code> (create the directory if necessary, and the file).</p>\n</div>\n<hr>\n<div class=\"literalblock\">\n<div class=\"content\">\n<pre class=\"nowrap\">import jenkins.*;\nimport jenkins.model.*;\nimport hudson.model.*;\n\n// disabled CLI access over TCP listener (separate port)\ndef p = AgentProtocol.all()\np.each { x -&gt;\n  if (x.name.contains(\"CLI\")) p.remove(x)\n}\n\n// disable CLI access over /cli URL\ndef removal = { lst -&gt;\n  lst.each { x -&gt; if (x.getClass().name.contains(\"CLIAction\")) lst.remove(x) }\n}\ndef j = Jenkins.instance;\nremoval(j.getExtensionList(RootAction.class))\nremoval(j.actions)</pre>\n</div>\n</div>\n<hr>\n<div class=\"paragraph\">\n<p>in order to make the workaround persist between restarts of the Jenkins server, add the script below to <code>$JENKINS_HOME/init.groovy.d/cli-shutdown.groovy</code> (create the directory if necessary, and the file).</p>\n</div>\n<div class=\"paragraph\">\n<p>The latest version of this script can be found <a href=\"https://github.com/jenkinsci-cert/SECURITY-218\">in this GitHub repository</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>As previously announced on the <a href=\"https://groups.google.com/d/forum/jenkinsci-advisories\">jenkinsci-advisories</a> mailing list we&#8217;re preparing a security release for this upcoming Wednesday which will include patches for both the latest and LTS lines of Jenkins core. The Jenkins Security team is working to include a fix for this previously undisclosed exploit in or before this planned security release.</p>\n</div>\n<div class=\"paragraph\">\n<p>If you have questions about this exploit, join us in the <a href=\"https://webchat.freenode.net/?channels=%23jenkins&amp;uio=d4\">#jenkins channel on Freenode</a> or ask on the <a href=\"https://groups.google.com/d/forum/jenkinsci-users\">jenkinsci-users@ mailing list</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>For security researchers and hobbyists, if you believe you have found a security vulnerability in Jenkins, we have some disclosure guidelines <a href=\"https://wiki.jenkins.io/display/JENKINS/Security+Advisories\">on this wiki page</a> which will help us mitigate any discovered issues as quickly and safely as possible.</p>\n</div>\n<hr>\n<div class=\"paragraph\">\n<p>Be sure to subscribe to the jenkinsci-advisories mailing list (<a href=\"https://groups.google.com/d/forum/jenkinsci-advisories\">jenkinsci-advisories</a>), it&#8217;s the fastest way to get updates by the Jenkins Security team.</p>\n</div>","id":"fb8e9590-268f-5f5b-aec2-bd427c6b0b5c","title":"Mitigating unauthenticated remote code execution 0-day in Jenkins CLI","date":"2015-11-06T00:00:00.000Z","slug":"/blog/2015/11/06/mitigating-unauthenticated-remote-code-execution-0-day-in-jenkins-cli/","links":{"discourse":""},"authors":[{"avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/19e71/rtyler.jpg","srcSet":"/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/77b35/rtyler.jpg 32w,\n/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/d4a57/rtyler.jpg 64w,\n/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/19e71/rtyler.jpg 128w,\n/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/68974/rtyler.jpg 256w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[{"srcSet":"/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/ef6ff/rtyler.webp 32w,\n/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/8257c/rtyler.webp 64w,\n/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/6766a/rtyler.webp 128w,\n/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/22bfc/rtyler.webp 256w","type":"image/webp","sizes":"(min-width: 128px) 128px, 100vw"}]},"width":128,"height":128}},"publicURL":"/gatsby-jenkins-io/static/c98b6de76465e89f9f5e5b331e9abfea/rtyler.jpeg"},"blog":"http://unethicalblogger.com","github":"rtyler","html":"<div class=\"paragraph\">\n<p>R&#46; Tyler Croy has been part of the Jenkins project for the past seven years.\nWhile avoiding contributing any Java code, Tyler is involved in many of the\nother aspects of the project which keep it running, such as this website,\ninfrastructure, governance, etc.</p>\n</div>","id":"rtyler","irc":null,"linkedin":null,"name":"R. Tyler Croy","slug":"/blog/authors/rtyler/","twitter":"agentdero"}]}},"pageContext":{"id":"fb8e9590-268f-5f5b-aec2-bd427c6b0b5c"}},
    "staticQueryHashes": ["1271460761","3649515864"]}