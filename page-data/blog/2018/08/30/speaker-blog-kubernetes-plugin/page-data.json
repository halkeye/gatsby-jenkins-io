{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2018/08/30/speaker-blog-kubernetes-plugin/",
    "result": {"data":{"blog":{"html":"<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nThis is a guest blog by Niklas Tanskanen, consultant at\n<a href=\"https://eficode.com\">Eficode</a>.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"imageblock right\">\n<div class=\"content\">\n<img src=\"/images/jenkins-x/logo.svg\" alt=\"Jenkins X\" width=\"200\">\n</div>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://kubernetes.io\">Kubernetes</a>, the container orchestration platform is rapidly becoming popular. There are more and more workloads that you can run on top of Kubernetes. It&#8217;s becoming an enabling layer of your Hyper-convergenced infrastructure.</p>\n</div>\n<div class=\"paragraph\">\n<p>If you set up Kubernetes as a Cloud provider in Jenkins, you&#8217;ll get a very powerful couple for running your workloads.\nTo do that, you can simply install\n<a href=\"https://plugins.jenkins.io/kubernetes\">Kubernetes plugin</a>.\nKubernetes is able to run your Jenkins workloads as long as they are run in container.\nAnd containers are an awesome way if your workload is a build, because you can pack all your application and OS dependencies in a container and then run it anywhere!</p>\n</div>\n<div class=\"paragraph\">\n<p>Let&#8217;s imagine that you have been running a Kubernetes cluster setup in your organisation for a while now.\nFirst it was all about proof of concept but now its becoming more popular within your developers and you have to think about scaling and orchestration.\nResource quotas are a part of that and every responsible operator should set those up both in both development and production clusters.\nOtherwise people will be lazy and just reserve all the resources of your cluster without actually using those resources for anything.\nBy introducing quotas into your cluster, you can control how many resources should each namespace have.</p>\n</div>\n<div class=\"paragraph\">\n<p>Quotas are a mature feature of Kubernetes already.\nYou have the possibility to create very fine grained quotas for different hardware resources, whenever it&#8217;s fast disk, GPUs or CPU time.\nYou can also specify multiple scopes of quota per one namespace.\nFor example, you can have a quota for workloads that are to be run to the infinity like web servers or databases.\nOr have quota for workloads that are short lived like builds or test automation runs.</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<caption class=\"title\">Table 1. Scopes</caption>\n<colgroup>\n<col style=\"width: 50%;\">\n<col style=\"width: 50%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">Scope</th>\n<th class=\"tableblock halign-left valign-top\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>Terminating</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Match pods where <code>.spec.activeDeadlineSeconds &gt;= 0</code></p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>NotTerminating</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Match pods where <code>.spec.activeDeadlineSeconds is nil</code></p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>BestEffort</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Match pods that have best effort quality of service.</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>NotBestEffort</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Match pods that do not have best effort quality of service.</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"sect1\">\n<h2 id=\"different-scopes-of-kubernetes-quota\"><a class=\"anchor\" href=\"#different-scopes-of-kubernetes-quota\"></a>Different scopes of Kubernetes quota</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Since Jenkins is all about running short workloads, you should aim for the <code>Terminating</code> scope of quota.\nBut how do you specify workloads in Jenkins so that correct scope is used?</p>\n</div>\n<div class=\"paragraph\">\n<p>If you were to do this in Kubernetes, you have to specify <code>.spec.activeDeadlineSeconds</code>.\nThe same field can also be specified by the Kubernetes plugin when you are specifying a Pod Template.</p>\n</div>\n<div class=\"imageblock\">\n<div class=\"content\">\n<img src=\"/images/post-images/2018-08-30/time-deadline.png\" alt=\"time deadline\" width=\"800\">\n</div>\n<div class=\"title\">Figure 1. Specifying <code>.spec.activeDeadlineSeconds</code> in the Kubernetes plugin</div>\n</div>\n<div class=\"paragraph\">\n<p>Same configuration is available in the <code>Jenkinsfile</code> as well if you don&#8217;t like static configurations.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight nowrap\"><code class=\"language-groovy\" data-lang=\"groovy\">podTemplate(label: 'maven', activeDeadlineSeconds: 180, containers: [\n    containerTemplate(name: 'maven', image: 'maven:3.5.4-jdk-10-slim')\n  ]) {\n  // maven magic\n}</code></pre>\n</div>\n</div>\n<div class=\"imageblock right\">\n<div class=\"content\">\n<a class=\"image\" href=\"https://www.cloudbees.com/devops-world\"><img src=\"/images/conferences/devops-world-2018.jpg\" alt=\"DevOps World | Jenkins World 2018\"></a>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>This was just a small sample of features of the Kubernetes plugin in Jenkins. For more, be sure to check out our\n<a href=\"https://sched.co/FD6E\">talk</a> where we share more of how you can utilise Kubernetes with Jenkins!</p>\n</div>\n<div class=\"admonitionblock warning\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-warning\" title=\"Warning\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>Come see Niklas Tanskanen and many other Jenkins experts and contributors at\n<a href=\"https://www.cloudbees.com/devops-world\">Jenkins World</a> on September 16-19th,\nregister with the code <code>JWFOSS</code> for a 30% discount off your pass.</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>","id":"76fe30c4-d5ca-529d-af0c-044c46a5a864","title":"Effectively using Kubernetes plugin with Jenkins","date":"2018-08-30T00:00:00.000Z","slug":"/blog/2018/08/30/speaker-blog-kubernetes-plugin/","links":{"discourse":""},"authors":[{"avatar":null,"blog":null,"github":"tanskann","html":"","id":"tanskann","irc":null,"linkedin":null,"name":"Niklas Tanskanen","slug":"blog/author/tanskann","twitter":null}]}},"pageContext":{"next":"/blog/2018/08/31/shifting-gears/","previous":"/blog/2018/08/29/day-of-jenkins-and-other-chances-to-meet-jcasc/","id":"76fe30c4-d5ca-529d-af0c-044c46a5a864"}},
    "staticQueryHashes": ["1271460761","3649515864"]}