{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2018/03/15/jep-200-lts/",
    "result": {"data":{"blog":{"html":"<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>This is a post about a major change in Jenkins, which is available starting\nfrom Jenkins 2.102 and Jenkins LTS 2.107.1.\nThis is a change with a serious risk of regressions in plugins.\nIf you are a Jenkins administrator, please read this blogpost and\n<a href=\"/doc/upgrade-guide/2.107/#upgrading-to-jenkins-lts-2-107-1\">upgrade guidelines</a>\n<strong>BEFORE</strong> upgrading.</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>I would like to provide some heads-up about the\n<a href=\"https://github.com/jenkinsci/jep/blob/master/jep/200/README.adoc\">JEP-200</a> change,\nwhich is included into the new Jenkins LTS 2.107.x baseline.</p>\n</div>\n<div class=\"sect1\">\n<h2 id=\"background\"><a class=\"anchor\" href=\"#background\"></a>Background</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>For many years Jenkins used to specifically <em>blacklist</em> certain classes and packages according to known or suspected exploits.\nThis approach has been proven unsustainable due to the risk of deserialization attacks via unknown classes\nfrom 3rd-party components, after the\n<a href=\"/security/advisory/2017-04-26/#cli-unauthenticated-remote-code-execution\">SECURITY-429/CVE-2017-1000353</a> fix in 2.46.2\nit was decided to replace blacklists by more restrictive whitelists.\nIn October 2017 <a href=\"https://github.com/jglick\">Jesse Glick</a> proposed a Jenkins Enhancement Proposal,\nwhich finally got accepted as <a href=\"https://github.com/jenkinsci/jep/blob/master/jep/200/README.adoc\">JEP-200</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>The change implies a risk of regressions in plugins serializing non-whitelisted Java-internal and 3rd-party classes,\nand that&#8217;s why it is so important to follow the upgrade guidelines for this release.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"current-state\"><a class=\"anchor\" href=\"#current-state\"></a>Current state</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>JEP-200 was first integrated in Jenkins 2.102 (released in January 2018), and it has got a lot of testing since that.\nSee <a href=\"/blog/2018/01/13/jep-200/\">this blogpost</a> for the original announcement.</p>\n</div>\n<div class=\"paragraph\">\n<p>Over the last two months we received more than <strong>75 issues</strong> from users of Jenkins weekly releases.\nAll these issues have been triaged, and we have released most of the fixes.\nMore than <strong>50 plugins</strong> were fixed in total, and many more plugins were updated in order to enable compatibility testing.\nA significant part of the discovered regressions were caused by real defects which were causing performance and stability\nissues in plugins.\nThanks a lot to all the Jenkins contributors and plugin maintainers who helped deliver timely changes for this effort!</p>\n</div>\n<div class=\"paragraph\">\n<p>Over last 6 weeks Jenkins weekly releases had positive community ratings,\nthe overall JEP-200 adoption reached ~12% of all Jenkins installations on March 01.\nAll major plugins have been also tested directly or verified in the wild on weekly releases.\nSo we are confident that the change is ready to be released in LTS.</p>\n</div>\n<div class=\"paragraph\">\n<p>On the other hand, we continue to receive JEP-200 regression reports.\nThey are mostly caused by niche plugins which are not widely used in weekly releases,\nand unfortunately not all fixes have been released yet (see <a href=\"https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+fix+for+JEP-200\">the Wiki page</a> for up-to-date info).\nWe anticipate more regressions to be reported after the LTS release and broader adoption.</p>\n</div>\n<div class=\"paragraph\">\n<p>In order to simplify the upgrade to the new LTS baseline,\nI have prepared some helpful materials together with <a href=\"https://github.com/bitwiseman\">Liam Newman</a>\nand <a href=\"https://github.com/jglick\">Jesse Glick</a>.\nBelow you can find the embedded slide deck and video, or scroll down to see the key information\nin the text form.</p>\n</div>\n<center>\n  <iframe width=\"720\" height=\"400\" frameborder=\"0\"\n  src=\"https://speakerdeck.com/player/f2b7e049ec46424b98ec4f0b58fd33bf\"></iframe>\n</center>\n<div class=\"paragraph\">\n<p>Video:</p>\n</div>\n<center>\n  <iframe width=\"720\" height=\"400\" frameborder=\"0\"\n    src=\"https://www.youtube-nocookie.com/embed/Vfnc9t1RuYA?rel=0\"></iframe>\n</center>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"for-jenkins-administrators\"><a class=\"anchor\" href=\"#for-jenkins-administrators\"></a>For Jenkins administrators</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Upgrading to a core with JEP-200 requires a special update procedure, which is described below.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"upgrading-jenkins\"><a class=\"anchor\" href=\"#upgrading-jenkins\"></a>Upgrading Jenkins</h3>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>JEP-200 is not the only major change in 2.107.1, please read\nthe <a href=\"/doc/upgrade-guide/2.107/#upgrading-to-jenkins-lts-2-107-1\">full upgrade guide</a> carefully</p>\n</li>\n<li>\n<p>If you have a way of testing the upgrade before applying it to production, do it</p>\n</li>\n<li>\n<p>Back up your instance so you have any easy way of rolling back</p>\n</li>\n<li>\n<p>Update all affected plugins.\nSee <a href=\"https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+fix+for+JEP-200\">this Wiki page</a> for the list of affected plugins,\nfix statuses and workarounds</p>\n</li>\n<li>\n<p>Apply workarounds for non-released patches if needed (see below)</p>\n</li>\n<li>\n<p>Update to the new version of the Jenkins core</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>Using backups and staging servers is good advice before <em>any</em> upgrade but especially this one,\ngiven the relatively high risk of regression.\nDue to the nature of the changes, some plugins may refuse to load after the upgrade and cause your Jenkins service to fail to start.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"after-the-upgrade\"><a class=\"anchor\" href=\"#after-the-upgrade\"></a>After the upgrade</h3>\n<div class=\"paragraph\">\n<p>To the extent that advance testing of the impact of this change on popular plugins has been completed,\nmost users (and even plugin developers) should not notice any difference.\nStill, it is highly advised to monitor your system after the upgrade, especially the following:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Jenkins System log (especially during the startup)</p>\n</li>\n<li>\n<p>Job/Build logs</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>If you do encounter a log message referencing the <code><a href=\"https://jenkins.io/redirect/class-filter/\" class=\"bare\">https://jenkins.io/redirect/class-filter/</a></code> URL,\nmost likely it is a JEP-200 regression.\nExample:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight nowrap\"><code>some.pkg.and.ClassName in file:/var/lib/jenkins/plugins/some-plugin-name/WEB-INF/lib/some-library-1.2.jar might be dangerous, so rejecting; see https://jenkins.io/redirect/class-filter/</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>If you see this kind of message, we highly recommend reporting it so that it can be investigated and probably fixed quickly.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"reporting-jep-200-issues\"><a class=\"anchor\" href=\"#reporting-jep-200-issues\"></a>Reporting JEP-200 issues</h3>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>Starting from May 01, JEP-200 issues are triaged by plugin and core maintainers.\nJEP-200 maintainers are available for code reviews if needed,\nbut they will not be reviewing cases in JIRA and searching for miscategorized issues on a daily basis.\nIf you experience new JEP-200 regressions, please follow the guidelines below.</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Please report any issues you encounter matching the above pattern in the\n<a href=\"https://issues.jenkins.io/\">Jenkins issue tracker</a>, under the appropriate plugin component.\nBefore reporting please check whether this issue has already been reported.</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Add the <code>JEP-200</code> label</p>\n</li>\n<li>\n<p>Include the stacktrace you see in the log</p>\n</li>\n<li>\n<p>If possible, include complete steps to reproduce the problem from scratch</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>You can find examples of previously reported issues using <a href=\"https://issues.jenkins.io/issues/?jql=labels%20%3D%20JEP-200\">this query</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins developers will evaluate issues and strive to offer a fix in the form of a core and/or plugin update.\nRight after the feature release there was be a special team triaging the reports.\nStarting from May 01 the issues will be triaged by plugin and core maintainers.\nSee <a href=\"https://github.com/jenkinsci/jep/tree/master/jep/200#rollout-plan\">JEP-200 Maintenance plan</a> for more info.</p>\n</div>\n<div class=\"paragraph\">\n<p>For more details and current status, see\n<a href=\"https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+fix+for+JEP-200\">Plugins affected by fix for JEP-200</a>.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"applying-workarounds\"><a class=\"anchor\" href=\"#applying-workarounds\"></a>Applying workarounds</h3>\n<div class=\"paragraph\">\n<p>Assuming you see no particular reason to think that the class in question has dangerous deserialization semantics, which is rare,\nit is possible to work around the problem in your own installation as a temporary expedient.\nNote the class name(s) mentioned in the JEP-200 log messages,\nand run Jenkins with the <code>hudson.remoting.ClassFilter</code> startup option, e.g.:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight nowrap\"><code class=\"language-bash\" data-lang=\"bash\">java -Dhudson.remoting.ClassFilter=some.pkg.and.ClassName,some.pkg.and.OtherClassName -jar jenkins.war ...</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>This workaround process may require several iterations, because classes whitelisted in the workaround may also\ninclude fields with types requiring whitelisting.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"for-plugin-developers\"><a class=\"anchor\" href=\"#for-plugin-developers\"></a>For plugin developers</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>If you are a plugin developer, please see <a href=\"/blog/2018/01/13/jep-200/\">the original JEP-200 announcement</a>.\nThat blog post provides guidelines for testing and fixing plugin compatibility after the JEP-200 changes.\nThe presentation above also provides some information about what needs to be tested.</p>\n</div>\n</div>\n</div>","id":"f1ff4387-7033-572c-9fef-b871cfb88ad0","title":"Security hardening: Jenkins LTS 2.107.1 switches XStream / Remoting blacklists to whitelists (JEP-200)","date":"2018-03-15T00:00:00.000Z","slug":"/blog/2018/03/15/jep-200-lts/","links":{"discourse":""},"authors":[{"avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#b8c8e8","images":{"fallback":{"src":"/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/bf8e1/oleg_nenashev.png","srcSet":"/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/914ee/oleg_nenashev.png 32w,\n/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/1c9ce/oleg_nenashev.png 64w,\n/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/bf8e1/oleg_nenashev.png 128w,\n/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/acb7c/oleg_nenashev.png 256w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[{"srcSet":"/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/ef6ff/oleg_nenashev.webp 32w,\n/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/8257c/oleg_nenashev.webp 64w,\n/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/6766a/oleg_nenashev.webp 128w,\n/gatsby-jenkins-io/static/611f92ce782a36a3a1454a29c79753db/22bfc/oleg_nenashev.webp 256w","type":"image/webp","sizes":"(min-width: 128px) 128px, 100vw"}]},"width":128,"height":128}}},"blog":"https://oleg-nenashev.github.io/","github":"oleg-nenashev","html":"<div class=\"paragraph\">\n<p>Jenkins core maintainer and board member.\nOleg started using Hudson for Hardware/Embedded projects in 2008 and became an active Jenkins contributor in 2012.\nNowadays he leads several Jenkins <a href=\"/sigs\">SIGs</a>, outreach programs (<a href=\"/projects/gsoc\">Google Summer of Code</a>, <a href=\"/events/hacktoberfest\">Hacktoberfest</a>) and <a href=\"/projects/jam/\">Jenkins meetups</a> in Switzerland and Russia.\nOleg works for <a href=\"https://www.cloudbees.com/\">CloudBees</a> and focuses on key projects in the community.</p>\n</div>","id":"oleg_nenashev","irc":"oleg_nenashev","linkedin":"onenashev","name":"Oleg Nenashev","slug":"/blog/author/oleg_nenashev","twitter":"oleg_nenashev"}]}},"pageContext":{"next":"/blog/2018/03/19/introducing-jenkins-x/","previous":"/blog/2018/03/12/browser-usage/","id":"f1ff4387-7033-572c-9fef-b871cfb88ad0"}},
    "staticQueryHashes": ["1271460761","3649515864"]}