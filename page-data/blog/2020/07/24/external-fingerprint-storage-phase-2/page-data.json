{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2020/07/24/external-fingerprint-storage-phase-2/",
    "result": {"data":{"blog":{"html":"<div class=\"paragraph\">\n<p>As another great phase for the\n<a href=\"/projects/gsoc/2020/projects/external-fingerprint-storage/\">External Fingerprint Storage Project</a>\ncomes to an end, we summarise the work done during this phase in this blog post.\nIt was an exciting and fruitful journey, just like the previous phase, and offered some great learning experience.</p>\n</div>\n<div class=\"paragraph\">\n<p>To understand what the project is about and the past progress, please refer to the\n<a href=\"https://www.jenkins.io/blog/2020/06/27/external-fingerprint-storage/\">phase 1 blog post</a>.</p>\n</div>\n<div class=\"sect1\">\n<h2 id=\"new-stories-completed\"><a class=\"anchor\" href=\"#new-stories-completed\"></a>New Stories Completed</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>We targeted four stories in this phase, namely fingerprint cleanup, fingerprint migration, refactoring the current\nimplementation to use descriptors, and improved testing of the Redis Fingerprint Storage Plugin.\nWe explain these stories in detail below.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"fingerprint-cleanup\"><a class=\"anchor\" href=\"#fingerprint-cleanup\"></a>Fingerprint Cleanup</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/jenkins/pull/4817\" class=\"bare\">https://github.com/jenkinsci/jenkins/pull/4817</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/23\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/23</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>This story involved extending the <code>FingerprintStorage</code> API to allow external storage plugins to perform and configure\ntheir own fingerprint cleanup strategies.\nWe added the following functionalities to Jenkins core API:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>FingerprintStorage#iterateAndCleanupFingerprints(TaskListener taskListener)</code></p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>This allows external fingerprint storage implementations to implement their own custom fingerprint cleanup.\nThe method is called periodically by Jenkins core.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><code>FingerprintStorage#cleanFingerprint(Fingerprint fingerprint, TaskListener taskListener)</code></p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>This is a reference implementation which can be called by external storage plugins to clean up a fingerprint.\nIt is upto the plugin implementation to decide whether to use this method.\nThey may choose to write a custom implementation.</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>We consume these new API functionalities in the\n<a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin\">Redis Fingerprint Storage plugin</a>.\nThe plugin uses cursors to traverse the fingerprints, updating the build information, and deleting the build-less\nfingerprints.</p>\n</div>\n<div class=\"paragraph\">\n<p>Earlier, fingerprint cleanup was always run periodically and there was no way to turn it off.\nWe also added an option to allow the user to turn off fingerprint cleanup.</p>\n</div>\n<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2020/07-external-fingerprint-storage-phase-2/cleanup_disable.png\" alt=\"Fingerprint cleanup disable\"></span></p>\n</div>\n<div class=\"paragraph\">\n<p>This was done because it may be the case that keeping redundant fingerprints in memory might be cheaper than the\ncleanup operation (especially in the case of external storages, which are cheaper these days).</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"fingerprint-migration\"><a class=\"anchor\" href=\"#fingerprint-migration\"></a>Fingerprint Migration</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/jenkins/pull/4825\" class=\"bare\">https://github.com/jenkinsci/jenkins/pull/4825</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Earlier, there was no support for fingerprints stored in the local storage.\nIn this phase, we introduce migration support for users.\nThe old fingerprints are now migrated to the new configured external storage whenever they are used (lazy migration).\nThis allows gradual migration of old fingerprints from local disk storage to the new external storage.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"refactor-fingerprintstorage-to-use-descriptors\"><a class=\"anchor\" href=\"#refactor-fingerprintstorage-to-use-descriptors\"></a>Refactor <code>FingerprintStorage</code> to use descriptors</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/jenkins/pull/4834\" class=\"bare\">https://github.com/jenkinsci/jenkins/pull/4834</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/36\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/36</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Earlier, whenever an external fingerprint storage plugin was installed, it was enabled by default.\nWe refactored the implementation to make use of <code>Descriptor</code> pattern so the fingerprint engine can now be selected\nas a dropdown from the Jenkins configuration page.\nThe dropdown is shown only when multiple fingerprint storage engines are configured on the system.\n<a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin\">Redis Fingerprint Storage Plugin</a> was refactored\nto use this new implementation.</p>\n</div>\n<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2020/07-external-fingerprint-storage-phase-2/fingerprint_storage_engine_dropdown.png\" alt=\"Fingerprint Storage Engine Dropdown\"></span></p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"strengthened-testing-for-the-redis-fingerprint-storage-plugin\"><a class=\"anchor\" href=\"#strengthened-testing-for-the-redis-fingerprint-storage-plugin\"></a>Strengthened testing for the Redis Fingerprint Storage Plugin</h3>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/33\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/33</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>We introduced new connection tests in the\n<a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin\">Redis Fingerprint Storage Plugin</a>.\nThese tests allow testing of cases like slow connection, breakage of connection to Redis, etc.\nThese were implemented using the Toxiproxy module inside Testcontainers.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/31\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/31</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>We introduced test for Configuration-as-code (JCasC) compatibility with the plugin.\nThe documentation for configuring the plugin using JCasC was also added.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/39\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/39</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>We introduced a suite of authentication tests, to verify the proper working of the Redis authentication system.\nAuthentication uses the credentials plugin.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/32\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/32</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/36\" class=\"bare\">https://github.com/jenkinsci/redis-fingerprint-storage-plugin/pull/36</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>We strengthened our web UI testing to ensure that the configuration page for the plugin works properly as planned.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"other-miscellaneous-tasks\"><a class=\"anchor\" href=\"#other-miscellaneous-tasks\"></a>Other miscellaneous tasks</h3>\n<div class=\"paragraph\">\n<p>Please refer to the <a href=\"https://issues.jenkins.io/browse/JENKINS-62754\">Jira Epic</a> for this phase.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"releases\"><a class=\"anchor\" href=\"#releases\"></a>Releases ðŸš€</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Changes in the Jenkins core (except migration) were released in <a href=\"/changelog/#v2.248\">Jenkins 2.248</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>We drafted <a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/releases/tag/redis-fingerprint-storage-parent-1.0-rc-1\">1.0-rc-1</a>\nrelease for the <a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin\">Redis Fingerprint Storage Plugin</a>\nto deliver the changes.\nThis was an increment from the <a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/releases/tag/redis-fingerprint-storage-parent-0.1-alpha-1\">alpha release</a>\nwe had drafted at the end of the previous phase.\nThe plugin is now available at <a href=\"https://plugins.jenkins.io/redis-fingerprint-storage/\" class=\"bare\">https://plugins.jenkins.io/redis-fingerprint-storage/</a>!</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"trying-out-the-new-features\"><a class=\"anchor\" href=\"#trying-out-the-new-features\"></a>Trying out the new features!</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The latest release for the plugin can be downloaded from the update center, instructions for which can be\nfound in the <a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/blob/master/README.adoc\">README</a>\nof the plugin.\nWe appreciate you trying out the plugin, and welcome any suggestions, feature requests, bug reports, etc.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"acknowledgements\"><a class=\"anchor\" href=\"#acknowledgements\"></a>Acknowledgements</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The Redis Fingerprint Storage plugin is built and maintained by the Google Summer of Code (GSoC) Team for\n<a href=\"/projects/gsoc/2020/projects/external-fingerprint-storage/\">External Fingerprint Storage for\nJenkins</a>. Special thanks to <a href=\"https://github.com/oleg-nenashev\">Oleg Nenashev</a>,\n<a href=\"https://github.com/afalko\">Andrey Falko</a>, <a href=\"https://github.com/mikecirioli\">Mike Cirioli</a>,\n<a href=\"https://github.com/timja\">Tim Jacomb</a>, and the entire Jenkins community for all the contribution to this project.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"future-work\"><a class=\"anchor\" href=\"#future-work\"></a>Future Work</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Some of the topics we aim to tackle in the next phase include a new reference implementation (possibly backed\nby PostgreSQL), tracing, etc.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"reaching-out\"><a class=\"anchor\" href=\"#reaching-out\"></a>Reaching Out</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Feel free to reach out to us for any questions, feedback, etc. on the project&#8217;s <a href=\"https://gitter.im/jenkinsci/external-fingerprint-storage\">Gitter Channel</a> or the <a href=\"mailto:jenkinsci-dev@googlegroups.com\">Jenkins\nDeveloper Mailing list</a>.\nWe use Jenkins <a href=\"https://issues.jenkins.io/\">Jira</a> to track issues.\nFeel free to file issues under <code>redis-fingerprint-storage-plugin</code> component.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"other-links\"><a class=\"anchor\" href=\"#other-links\"></a>Other Links</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin\">Redis Fingerprint Storage Plugin</a></p>\n</li>\n<li>\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-62754\">Issue Tracker for Phase 2</a></p>\n</li>\n<li>\n<p>jep:226[]</p>\n</li>\n<li>\n<p><a href=\"https://gitter.im/jenkinsci/external-fingerprint-storage\">Gitter Channel</a></p>\n</li>\n<li>\n<p><a href=\"/projects/gsoc/2020/projects/external-fingerprint-storage/\">Project Page</a></p>\n</li>\n<li>\n<p><a href=\"/blog/2020/06/27/external-fingerprint-storage/\">Phase 1 Blog Post</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","id":"4bb5ba32-d613-5603-8d83-2dabce9481fa","title":"External Fingerprint Storage Phase-2 Updates","date":"2020-07-24T00:00:00.000Z","slug":"/blog/2020/07/24/external-fingerprint-storage-phase-2/","links":{"discourse":""},"authors":[{"avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#281818","images":{"fallback":{"src":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/19e71/stellargo.jpg","srcSet":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/77b35/stellargo.jpg 32w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/d4a57/stellargo.jpg 64w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/19e71/stellargo.jpg 128w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[{"srcSet":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/ef6ff/stellargo.webp 32w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/8257c/stellargo.webp 64w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/6766a/stellargo.webp 128w","type":"image/webp","sizes":"(min-width: 128px) 128px, 100vw"}]},"width":128,"height":128}},"publicURL":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/stellargo.jpeg"},"blog":"https://medium.com/@sumitsarinofficial","github":"stellargo","html":"<div class=\"paragraph\">\n<p>Jenkins Google Summer of Code 2020 student. Sumit is an engineering student (senior) at Netaji Subhas Institute of Technology, University of Delhi. He started his journey of contributing to Jenkins in December 2019. His tiny contribution revolved around the Jenkins Fingerprint engine. He is currently working on building <a href=\"https://www.jenkins.io/projects/gsoc/2020/projects/external-fingerprint-storage\">External Fingerprint Storage for Jenkins</a>.</p>\n</div>","id":"stellargo","irc":null,"linkedin":"sumit-sarin","name":"Sumit Sarin","slug":"/blog/authors/stellargo","twitter":null}]}},"pageContext":{"id":"4bb5ba32-d613-5603-8d83-2dabce9481fa"}},
    "staticQueryHashes": ["1271460761","3649515864"]}