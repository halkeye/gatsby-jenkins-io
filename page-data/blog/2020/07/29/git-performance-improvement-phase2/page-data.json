{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2020/07/29/git-performance-improvement-phase2/",
    "result": {"data":{"blog":{"html":"<div class=\"paragraph\">\n<p>The second phase of the <a href=\"/blog/2020/07/09/git-performance-improvement-phase1/\">Git Plugin Performance Improvement project</a> has been great in terms of the progress we have achieved in implementing performance improvement insights\nderived from the phase one <a href=\"https://openjdk.java.net/projects/code-tools/jmh/\">JMH</a> micro-benchmark experiments.</p>\n</div>\n<div class=\"paragraph\">\n<p>What we&#8217;ve learned so far in this project is that a git fetch is highly correlated to the size of the remote repository. In order to make fetch improvements in this plugin, our task was to find the difference in performance for the two available git implementations in the <a href=\"https://github.com/jenkinsci/git-plugin\">Git Plugin</a>, <code>git</code> and <code>JGit</code>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Our major finding was that <code>git</code> performs much better than <code>JGit</code> when it comes to a large sized repository (&gt;100 MiB). Interestingly, <code>JGit</code> performs better than <code>git</code> when size of the repository is less than 100 MiB.</p>\n</div>\n<div class=\"paragraph\">\n<p>In this phase, we were successful in coding this derived knowledge from the benchmarks into a new functionality called the\nGitToolChooser.</p>\n</div>\n<div class=\"sect1\">\n<h2 id=\"gittoolchooser\"><a class=\"anchor\" href=\"#gittoolchooser\"></a>GitToolChooser</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>This class aims to add the functionality of recommending a git implementation on the basis of the size of a repository which has a strong correlation to the performance of git fetch (from performance Benchmarks).</p>\n</div>\n<div class=\"paragraph\">\n<p>It utilizes two heuristics to calculate the size:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Using cached .git dir from multibranch projects to estimate the size of a repository</p>\n</li>\n<li>\n<p>Providing an extension point which, upon implementation, can use REST APIs exposed by git service providers like Github, GitLab, etc to fetch the size of the remote repository.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Will it optimize your Jenkins instance?\nThat requires one of the following:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>you have a multibranch project in your Jenkins instance, the plugin can use that to recommend the optimal git implementation</p>\n</li>\n<li>\n<p>you have a branch Source Plugin installed in the Jenkins instance, the particular branch source plugin will recommend a git implementation using REST APIs provided by <a href=\"https://plugins.jenkins.io/github-branch-source/\">GitHub</a> or <a href=\"https://plugins.jenkins.io/gitlab-branch-source/\">GitLab</a> respectively.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>The architecture and code for this class is at: <a href=\"https://github.com/jenkinsci/git-plugin/pull/931\">PR-931</a></p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Note</strong>: This functionality is an upcoming feature in the subsequent Git Plugin release.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"jmh-benchmarks-in-multiple-environments\"><a class=\"anchor\" href=\"#jmh-benchmarks-in-multiple-environments\"></a>JMH benchmarks in multiple environments</h3>\n<div class=\"paragraph\">\n<p>The benchmarks were being executed on Linux and macOS machines frequently but there was a need to check if the results gained from those benchmarks would hold true across more platforms to ensure that the solution (GitToolChooser) is generally platform-agnostic.</p>\n</div>\n<div class=\"paragraph\">\n<p>To test this hypothesis, we performed an experiment:</p>\n</div>\n<div class=\"paragraph\">\n<p>Running git fetch operation for a 400 MiB sized repository on:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>Windows</code></p>\n</li>\n<li>\n<p><code>FreeBSD 12</code></p>\n</li>\n<li>\n<p><code>ppc64le</code></p>\n</li>\n<li>\n<p><code>s390x</code></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>The result of running this experiment is given below:</p>\n</div>\n<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2020/07-git-plugin-performance-improvement/git-multiple-platforms.png\" alt=\"Performance on multiple platforms\"></span></p>\n</div>\n<div class=\"paragraph\">\n<p>Observations:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>ppc64le</code> and <code>s390x</code> are able to run the operation in almost half the time it takes for the <code>Windows</code> or <code>FreeBSD 12</code> machine. This behavior may be attributed to the increased computational power of those machines.</p>\n</li>\n<li>\n<p>The difference in performance between <code>git</code> and <code>JGit</code> remains constant across all platforms which is a positive sign for the GitToolChooser as its recommendation would be consistent across multiple devices and operating systems.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"release-plan\"><a class=\"anchor\" href=\"#release-plan\"></a>Release Plan ðŸš€</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-49757\">JENKINS-49757</a> - Avoid double fetch from Git checkout step\nThis issue was fixed in phase one, avoids the second fetch in redundant cases.\nIt will be shipped with some benchmarks on the change in performance due to the removal of the second fetch.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/git-client-plugin/pull/574\">PR-574</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/jenkinsci/git-plugin/pull/904\">PR-904</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p><strong>GitToolChooser</strong></p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://github.com/jenkinsci/git-plugin/pull/931\">PR-931</a>\nThis pull request is under review, will be shipped in one of the subsequent Git Plugin releases.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Current Challenges with GitToolChooser</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Implement the extension point to support GitHub Branch Source Plugin, Gitlab Branch Source Plugin and Gitea Plugin.</p>\n</li>\n<li>\n<p>The current version of JGit doesn&#8217;t support LFS checkout and sparse checkout, need to make sure that the recommendation doesn&#8217;t break existing use cases.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"future-work\"><a class=\"anchor\" href=\"#future-work\"></a>Future Work</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>In phase three, we wish to:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Release a new version of the Git and Git Client Plugin with the features developed during the project</p>\n</li>\n<li>\n<p>Continue to explore more areas for performance improvement</p>\n</li>\n<li>\n<p>Add a new git operation: git clone (Stretch Goal)</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"reaching-out\"><a class=\"anchor\" href=\"#reaching-out\"></a>Reaching Out</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Feel free to reach out to us for any questions or feedback on the project&#8217;s <a href=\"https://gitter.im/jenkinsci/git-plugin\">Gitter Channel</a> or the <a href=\"mailto:jenkinsci-dev@googlegroups.com\">Jenkins\nDeveloper Mailing list</a>.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"/projects/gsoc/2020/projects/git-plugin-performance/\">Project Page</a></p>\n</li>\n<li>\n<p><a href=\"/blog/2020/07/09/git-performance-improvement-phase1/\">Phase 1 Blog Post</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","id":"84676949-9b05-55b1-b843-435c0ff0696d","title":"Git Plugin Performance Improvement Phase-2 Progress","date":"2020-07-29T00:00:00.000Z","slug":"/blog/2020/07/29/git-performance-improvement-phase2/","authors":[{"avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#685848","images":{"fallback":{"src":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/19e71/rishabhbudhouliya.jpg","srcSet":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/77b35/rishabhbudhouliya.jpg 32w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/d4a57/rishabhbudhouliya.jpg 64w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/19e71/rishabhbudhouliya.jpg 128w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/68974/rishabhbudhouliya.jpg 256w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[{"srcSet":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/ef6ff/rishabhbudhouliya.webp 32w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/8257c/rishabhbudhouliya.webp 64w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/6766a/rishabhbudhouliya.webp 128w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/22bfc/rishabhbudhouliya.webp 256w","type":"image/webp","sizes":"(min-width: 128px) 128px, 100vw"}]},"width":128,"height":128}},"publicURL":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/rishabhbudhouliya.jpg"},"blog":null,"github":"rishabhBudhouliya","html":"<div class=\"paragraph\">\n<p>GSoC 2020 student under the Jenkins project (Git Plugin Performance Improvements).\nAspiring to be better at Software Development and participate more in the open source\ncommunity.</p>\n</div>","id":"rishabhbudhouliya","irc":null,"linkedin":null,"name":"Rishabh Budhouliya","slug":"/blog/authors/rishabhbudhouliya/","twitter":null}]}},"pageContext":{"id":"84676949-9b05-55b1-b843-435c0ff0696d"}},
    "staticQueryHashes": ["1271460761","3649515864"]}