{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2020/07/09/git-performance-improvement-phase1/",
    "result": {"data":{"blog":{"html":"<div class=\"paragraph\">\n<p><a href=\"/projects/gsoc/2020/projects/git-plugin-performance/\">Git Plugin Performance Improvement</a> is a <a href=\"/projects/gsoc/#gsoc-2020\">Google Summer of Code 2020 project</a>.\nIt aims to improve the performance of the git plugin, which provides fundamental git functionalities.</p>\n</div>\n<div class=\"paragraph\">\n<p>Internally, the plugin provides these functionalities using two implementations: <a href=\"https://www.git-scm.com/\">command line git</a> and <a href=\"https://www.eclipse.org/jgit/\">JGit (pure java implementation)</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2020/07-git-plugin-performance-improvement/git-intro.png\" alt=\"git-intro\" width=\"938\"></span></p>\n</div>\n<div class=\"paragraph\">\n<p><strong>CLI git is the default implementation for the plugin, a user can switch to JGit if needed</strong></p>\n</div>\n<div class=\"paragraph\">\n<p>The project is divided into two parallel stages:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><strong>Stage 1</strong>: Create benchmarks which evaluate the execution time of a git operation provided by CLI git and JGit using JMH, a micro benchmarking test harness.</p>\n</li>\n<li>\n<p><strong>Stage 2</strong>: Implement the insights gained from the analysis into the plugin to improve the overall performance of the plugin.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>The project also aims to fix any existing performance bottlenecks within the plugin as well.</p>\n</div>\n<div class=\"sect1\">\n<h2 id=\"benchmarks\"><a class=\"anchor\" href=\"#benchmarks\"></a>Benchmarks</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The benchmarks are written using <a href=\"https://openjdk.java.net/projects/code-tools/jmh/\">JMH</a>. It was introduced in a <a href=\"https://www.jenkins.io/blog/2019/06/21/performance-testing-jenkins/\">GSoC 2019 project</a> to Jenkins.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>JMH is provided within the plugin through the Jenkins Unit Test Harness POM dependency.</p>\n</li>\n<li>\n<p>The JMH <a href=\"https://github.com/jenkinsci/git-client-plugin/tree/master/src/test/java/jmh/benchmark\">benchmarks</a> are created and run within the git client plugin</p>\n</li>\n<li>\n<p>During phase-1, we have created benchmarks for two operations: \"git fetch\" and \"git ls-remote\"</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"results-and-analysis\"><a class=\"anchor\" href=\"#results-and-analysis\"></a>Results and Analysis</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The benchmark analysis for git fetch:</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"git-fetch-results\"><a class=\"anchor\" href=\"#git-fetch-results\"></a>Git fetch results</h3>\n<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2020/07-git-plugin-performance-improvement/git-fetch-results.png\" alt=\"git-fetch-results\" width=\"938\"></span></p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The performance of git fetch (average execution time/op) is strongly correlated to the size of a repository</p>\n</li>\n<li>\n<p>There exists an inflection point on the scale of repository size after which the nature of JGit performance changes (it starts to degrade)</p>\n</li>\n<li>\n<p>After running multiple benchmarks, it is safe to say that for a large sized repository <strong>CLI-git</strong> would be a better choice of implementation.</p>\n</li>\n<li>\n<p>We can use this insight to implement a feature which avoids JGit when it comes to large repositories.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Please refer to <a href=\"https://github.com/jenkinsci/git-client-plugin/pull/521\">PR-521</a> for an elaborate explanation on these results</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Note:</strong> Repository size means <code>du -h .git</code></p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"fixing-redundant-fetch-issue\"><a class=\"anchor\" href=\"#fixing-redundant-fetch-issue\"></a>Fixing redundant fetch issue</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The git plugin performs two fetch operations instead of one while performing a fresh checkout of a remote git repository.</p>\n</div>\n<div class=\"paragraph\">\n<p>To <a href=\"https://github.com/jenkinsci/git-plugin/pull/904\">fix</a> this issue, we had to safely remove the second fetch keeping multiple use-cases in mind. The fix itself was not difficult to code, but to do that safely without breaking any existing use-case was a challenging task.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"further-plan\"><a class=\"anchor\" href=\"#further-plan\"></a>Further Plan</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>After consolidating a benchmarking strategy during Phase 1, the next steps will be:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Provide functionality to the git plugin, which enables it to estimate the size of the repository without cloning it.</p>\n</li>\n<li>\n<p>Broaden the scope of benchmarking strategy</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Consider parameters like number of branches, references and commit history to find a relation with the performance of a git operation</p>\n</li>\n<li>\n<p>The git plugin depends on other plugins like Credentials which might require benchmarking the plugin itself and the effects of these external dependencies on the plugin&#8217;s performance</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Focus on other use-cases of the plugin</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>For phase-1, I focused on the checkout step and the operations involved with it</p>\n</li>\n<li>\n<p>For the next phase, the focus will shift to other areas like Multibranch pipelines or Organisation Folders</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"how-can-you-help\"><a class=\"anchor\" href=\"#how-can-you-help\"></a>How can you help?</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>If you have reached this far of the blog, you might be interested in the project.</p>\n</div>\n<div class=\"paragraph\">\n<p>To help, you can</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Review the benchmarks in the <a href=\"https://github.com/jenkinsci/git-client-plugin/tree/master/src/test/java/jmh/benchmark\">benchmarks module</a></p>\n</li>\n<li>\n<p>Analyse the benchmarks results available on <a href=\"https://ci.jenkins.io/job/Plugins/job/git-client-plugin/job/master/\">ci.jenkins.io</a> [soon]</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Come visit our Gitter channel: <a href=\"https://gitter.im/jenkinsci/git-plugin\" class=\"bare\">https://gitter.im/jenkinsci/git-plugin</a></p>\n</div>\n</div>\n</div>","id":"615c1ac2-c3da-5001-be28-908ac6008d94","title":"Git Plugin Performance Improvement: Phase-1","date":"2020-07-09T00:00:00.000Z","slug":"/blog/2020/07/09/git-performance-improvement-phase1/","authors":[{"avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#685848","images":{"fallback":{"src":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/19e71/rishabhbudhouliya.jpg","srcSet":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/77b35/rishabhbudhouliya.jpg 32w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/d4a57/rishabhbudhouliya.jpg 64w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/19e71/rishabhbudhouliya.jpg 128w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/68974/rishabhbudhouliya.jpg 256w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[{"srcSet":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/ef6ff/rishabhbudhouliya.webp 32w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/8257c/rishabhbudhouliya.webp 64w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/6766a/rishabhbudhouliya.webp 128w,\n/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/22bfc/rishabhbudhouliya.webp 256w","type":"image/webp","sizes":"(min-width: 128px) 128px, 100vw"}]},"width":128,"height":128}},"publicURL":"/gatsby-jenkins-io/static/32fa8462b37abd3e057f4b70f0558972/rishabhbudhouliya.jpg"},"blog":null,"github":"rishabhBudhouliya","html":"<div class=\"paragraph\">\n<p>GSoC 2020 student under the Jenkins project (Git Plugin Performance Improvements).\nAspiring to be better at Software Development and participate more in the open source\ncommunity.</p>\n</div>","id":"rishabhbudhouliya","irc":null,"linkedin":null,"name":"Rishabh Budhouliya","slug":"/blog/authors/rishabhbudhouliya/","twitter":null}]}},"pageContext":{"id":"615c1ac2-c3da-5001-be28-908ac6008d94"}},
    "staticQueryHashes": ["1271460761","3649515864"]}