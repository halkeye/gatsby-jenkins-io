{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/blog/2020/08/25/external-fingerprint-storage-phase-3/",
    "result": {"data":{"blog":{"html":"<div class=\"paragraph\">\n<p>The final phase for the <a href=\"/projects/gsoc/2020/projects/external-fingerprint-storage/\">External Fingerprint Storage\nProject</a> has come to an end and to finish off, we release one more fingerprint storage plugin:\nthe <a href=\"https://github.com/jenkinsci/postgresql-fingerprint-storage-plugin\">PostgreSQL Fingerprint Storage Plugin</a>!</p>\n</div>\n<div class=\"paragraph\">\n<p>This post highlights the progress made during phase-3.\nTo understand what the project is about and the past progress, please refer to the\n<a href=\"/blog/2020/06/27/external-fingerprint-storage/\">phase-1 post</a> and the\n<a href=\"/blog/2020/06/27/external-fingerprint-storage/\">phase-2 post</a>.</p>\n</div>\n<div class=\"sect1\">\n<h2 id=\"introducing-the-postgresql-fingerprint-storage-plugin\"><a class=\"anchor\" href=\"#introducing-the-postgresql-fingerprint-storage-plugin\"></a>Introducing the PostgreSQL Fingerprint Storage Plugin</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"why-postgresql\"><a class=\"anchor\" href=\"#why-postgresql\"></a>Why PostgreSQL?</h3>\n<div class=\"paragraph\">\n<p>There were several reasons why it made sense to build another reference implementation, especially backed by PostgreSQL.</p>\n</div>\n<div class=\"paragraph\">\n<p>Redis is a key-value storage, and hence stores the fingerprints as blobs.\nThe PostgreSQL plugin defines a relational structure for fingerprints.\nThis offers a more powerful way to query the database for fingerprint information.\nFingerprint facets can store extra information inside the fingerprints, which cannot be queried in Redis directly.\nPostgreSQL plugin allows powerful (indexing) and efficient querying strategies which can even query the facet metadata.</p>\n</div>\n<div class=\"paragraph\">\n<p>Another reason for building this plugin was to provide a basis for other relational database plugins to be built.\nIt also validates the flexibility and design of our external fingerprint storage API.</p>\n</div>\n<div class=\"paragraph\">\n<p>Since PostgreSQL is a traditional disk storage database, it is more suitable for systems storing a massive number of\nfingerprints.</p>\n</div>\n<div class=\"paragraph\">\n<p>Among relational databases, PostgreSQL is quite popular, has extensive support, and is open-source.\nWe expect the new implementation to drive more adoption, and prove to be beneficial to the community.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"installation\"><a class=\"anchor\" href=\"#installation\"></a>Installation:</h3>\n<div class=\"paragraph\">\n<p>The plugin can be installed using the\n<a href=\"https://www.jenkins.io/doc/developer/publishing/releasing-experimental-updates/\">experimental update center</a>.\nFollow along the following steps after running Jenkins to download and install the plugin:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Select <code>Manage Jenkins</code></p>\n</li>\n<li>\n<p>Select <code>Manage Plugins</code></p>\n</li>\n<li>\n<p>Go to <code>Advanced</code> tab</p>\n</li>\n<li>\n<p>Configure the Update Site URL as: <code><a href=\"https://updates.jenkins.io/experimental/update-center.json\" class=\"bare\">https://updates.jenkins.io/experimental/update-center.json</a></code></p>\n</li>\n<li>\n<p>Click on <code>Submit</code>, and then press the <code>Check Now</code> button.</p>\n</li>\n<li>\n<p>Go to <code>Available</code> tab.</p>\n</li>\n<li>\n<p>Search for <code>PostgreSQL Fingerprint Storage Plugin</code> and check the box along it.</p>\n</li>\n<li>\n<p>Click on <code>Install without restart</code></p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>The plugin should now be installed on the system.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"usage\"><a class=\"anchor\" href=\"#usage\"></a>Usage</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Once the plugin has been installed, you can configure the PostgreSQL server details by following the steps below:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Select <code>Manage Jenkins</code></p>\n</li>\n<li>\n<p>Select <code>Configure System</code></p>\n</li>\n<li>\n<p>Scroll to the section <code>Fingerprints</code> and choose <code>PostgreSQL Fingerprint Storage</code> in the dropdown for\n<code>Fingerprint Storage Engine</code>.</p>\n</li>\n<li>\n<p>Configure the following parameters to connect to your PostgreSQL instance:</p>\n<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2020/08-external-fingerprint-storage-phase-3/configure.png\" alt=\"Configure Redis\"></span></p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>Host</code> - Enter hostname where PostgreSQL is running</p>\n</li>\n<li>\n<p><code>Port</code> - Specify the port on which PostgreSQL is running</p>\n</li>\n<li>\n<p><code>SSL</code> - Click if SSL is enabled</p>\n</li>\n<li>\n<p><code>Database Name</code> - Specify the database name inside the PostgreSQL instance to be used. Please note that the database\nwill not be created by the plugin, the user has to create the database.</p>\n</li>\n<li>\n<p><code>Connection Timeout</code> - Set the connection timeout duration in seconds.</p>\n</li>\n<li>\n<p><code>Socket Timeout</code> - Set the socket timeout duration in seconds.</p>\n</li>\n<li>\n<p><code>Credentials</code> - Configure authentication using username and password to the PostgreSQL instance.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Use the <code>Test PostgreSQL Connection</code> button to verify that the details are correct and Jenkins is able to connect to\nthe PostgreSQL instance.</p>\n</li>\n<li>\n<p>[IMPORTANT] When configuring the plugin for the first time, it is highly important to press the Perform PostgreSQL\nSchema Initialization button. It will automatically perform schema initialization and create the necessary indexes.\nThe button can also be used in the case the database is wiped out and schema needs to be recreated.</p>\n</li>\n<li>\n<p>Press the <code>Save</code> button.</p>\n</li>\n<li>\n<p>Now, all the fingerprints produced by this Jenkins instance should be saved in the configured PostgreSQL instance!</p>\n</li>\n</ol>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"querying-the-fingerprint-database\"><a class=\"anchor\" href=\"#querying-the-fingerprint-database\"></a>Querying the Fingerprint Database</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Due to the relational structure defined by PostgreSQL, it allows users/developers to query the fingerprint data which\nwas not possible using the Redis fingerprint storage plugin.</p>\n</div>\n<div class=\"paragraph\">\n<p>The fingerprint storage can act as a consolidated storage for multiple Jenkins instances.\nFor example, to search for a fingerprint id across Jenkins instances using the file name, the following query could be\nused:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight nowrap\"><code>SELECT fingerprint_id FROM fingerprint.fingerprint\nWHERE filename = 'random_file';</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>A sample query is provided which can be tweaked depending on the parameters to be searched:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight nowrap\"><code>SELECT * FROM fingerprint.fingerprint\nWHERE fingerprint_id = 'random_id'\n        AND instance_id = 'random_jenkins_instance_id'\n        AND filename = 'random_file'\n        AND original_job_name = 'random_job'\n        AND original_job_build_number = 'random_build_number'\n        AND timestamp BETWEEN '2019-12-01 23:59:59'::timestamp AND now()::timestamp</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The facets are stored in the database as <code>jsonb</code>.\nPostgreSQL offers support to query <code>jsonb</code>.\nThis is especially useful for querying the information stored inside fingerprint facets.\nAs an example, the <a href=\"https://plugins.jenkins.io/docker-traceability\">Docker Traceability Plugin</a> stores information like the name of Docker images inside these\nfacets.\nThese can be queried across Jenkins instances like so:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight nowrap\"><code>SELECT * FROM fingerprint.fingerprint_facet_relation\nWHERE facet_entry-&gt;&gt;'imageName' = 'random_container';</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>At the moment these queries require working knowledge of the database.\nIn future, these queries can be abstracted away by plugins and the features made available to users directly inside\nJenkins.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"demo\"><a class=\"anchor\" href=\"#demo\"></a>Demo</h2>\n<div class=\"sectionbody\">\n<div class=\"videoblock\">\n<div class=\"title\">External Fingerprint Storage Demo</div>\n<div class=\"content\">\n<iframe width=\"800\" height=\"420\" src=\"https://www.youtube.com/embed/HvbbsoljLyg?rel=0\" frameborder=\"0\" allowfullscreen></iframe>\n</div>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://docs.google.com/presentation/d/1QL5m-7QGtep_G1ysEYKRauAHzDq8nTtOdcnE1t4aYE8/edit?usp=sharing\">Slide deck</a></p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"releases\"><a class=\"anchor\" href=\"#releases\"></a>Releases ðŸš€</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>We released the <code>0.1-alpha-1</code> version for the <a href=\"https://github.com/jenkinsci/postgresql-fingerprint-storage-plugin\">\nPostgreSQL Fingerprint Storage Plugin</a>.\nPlease refer to the\n<a href=\"https://github.com/jenkinsci/postgresql-fingerprint-storage-plugin/releases/tag/postgresql-fingerprint-storage-0.1-alpha-1\">\nchangelog</a> for more information.</p>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://plugins.jenkins.io/redis-fingerprint-storage/\">Redis Fingerprint Storage Plugin</a> <code>1.0-rc-3</code> was also\nreleased.\nThe\n<a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin/releases/tag/redis-fingerprint-storage-parent-1.0-rc-3\">\nchangelog</a> provides more details.</p>\n</div>\n<div class=\"paragraph\">\n<p>A few API changes made in the Jenkins core were released in <a href=\"/changelog/#v2.253\">Jenkins-2.253</a>.\nIt mainly includes exposing fingerprint range set serialization methods for plugins.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"future-directions\"><a class=\"anchor\" href=\"#future-directions\"></a>Future Directions</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The relational structure of the plugin allows some performance improvements that can be made when implementing\ncleanup, as well as improving the performance of <code>Fingerprint#add(String job, int buildNumber)</code>.\nThese designs were discussed and are a scope of future improvement.</p>\n</div>\n<div class=\"paragraph\">\n<p>The current external fingerprint storage API supports configuring multiple Jenkins instances to a single storage.\nThis opens up the possibility of developing traceability plugins which can track fingerprints across Jenkins instances.</p>\n</div>\n<div class=\"paragraph\">\n<p>Please consider reaching out to us if you feel any of the use cases would benefit you, or if you would like to share\nsome new use cases.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"acknowledgements\"><a class=\"anchor\" href=\"#acknowledgements\"></a>Acknowledgements</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The PostgreSQL Fingerprint Storage Plugin and the Redis Fingerprint Storage plugin are maintained by the\nGoogle Summer of Code (GSoC) Team for <a href=\"/projects/gsoc/2020/projects/external-fingerprint-storage/\">External\nFingerprint Storage for Jenkins</a>.\nSpecial thanks to <a href=\"https://github.com/oleg-nenashev\">Oleg Nenashev</a>,\n<a href=\"https://github.com/afalko\">Andrey Falko</a>, <a href=\"https://github.com/mikecirioli\">Mike Cirioli</a>,\n<a href=\"https://github.com/timja\">Tim Jacomb</a>, and the entire Jenkins community for all the contribution to this project.</p>\n</div>\n<div class=\"paragraph\">\n<p>As we wrap up, we would like to point out that there are plenty of future directions and use cases for the externalized\nfingerprint storage, as mentioned in the previous section, and we welcome everybody to contribute.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"reaching-out\"><a class=\"anchor\" href=\"#reaching-out\"></a>Reaching Out</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Feel free to reach out to us for any questions, feedback, etc. on the project&#8217;s\n<a href=\"https://gitter.im/jenkinsci/external-fingerprint-storage\">Gitter Channel</a> or the\n<a href=\"mailto:jenkinsci-dev@googlegroups.com\">Jenkins Developer Mailing list</a>.\nWe use Jenkins <a href=\"https://issues.jenkins.io/\">Jira</a> to track issues.\nFeel free to file issues under either the <code>postgresql-fingerprint-storage-plugin</code> or the\n<code>redis-fingerprint-storage-plugin</code> component depending on the plugin.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"other-links\"><a class=\"anchor\" href=\"#other-links\"></a>Other Links</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"/blog/2020/06/27/external-fingerprint-storage/\">Phase 1 Post</a></p>\n</li>\n<li>\n<p><a href=\"/blog/2020/06/27/external-fingerprint-storage/\">Phase 2 Post</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/jenkinsci/postgresql-fingerprint-storage-plugin\">PostgreSQL Fingerprint Storage Plugin</a></p>\n</li>\n<li>\n<p><a href=\"https://github.com/jenkinsci/redis-fingerprint-storage-plugin\">Redis Fingerprint Storage Plugin</a></p>\n</li>\n<li>\n<p>jep:226[]</p>\n</li>\n<li>\n<p><a href=\"https://gitter.im/jenkinsci/external-fingerprint-storage\">Gitter Channel</a></p>\n</li>\n<li>\n<p><a href=\"/projects/gsoc/2020/projects/external-fingerprint-storage/\">Project Page</a></p>\n</li>\n</ul>\n</div>\n</div>\n</div>","id":"7a744457-8457-529e-9c68-1e00d5e790df","title":"External Fingerprint Storage Phase-3 Update: Introducing the PostgreSQL Fingerprint Storage Plugin","date":"2020-08-25T00:00:00.000Z","slug":"/blog/2020/08/25/external-fingerprint-storage-phase-3/","authors":[{"avatar":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#281818","images":{"fallback":{"src":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/19e71/stellargo.jpg","srcSet":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/77b35/stellargo.jpg 32w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/d4a57/stellargo.jpg 64w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/19e71/stellargo.jpg 128w","sizes":"(min-width: 128px) 128px, 100vw"},"sources":[{"srcSet":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/ef6ff/stellargo.webp 32w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/8257c/stellargo.webp 64w,\n/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/6766a/stellargo.webp 128w","type":"image/webp","sizes":"(min-width: 128px) 128px, 100vw"}]},"width":128,"height":128}},"publicURL":"/gatsby-jenkins-io/static/57deb704d1eb39e35b9de4a8c22ea56e/stellargo.jpeg"},"blog":"https://medium.com/@sumitsarinofficial","github":"stellargo","html":"<div class=\"paragraph\">\n<p>Jenkins Google Summer of Code 2020 student. Sumit is an engineering student (senior) at Netaji Subhas Institute of Technology, University of Delhi. He started his journey of contributing to Jenkins in December 2019. His tiny contribution revolved around the Jenkins Fingerprint engine. He is currently working on building <a href=\"https://www.jenkins.io/projects/gsoc/2020/projects/external-fingerprint-storage\">External Fingerprint Storage for Jenkins</a>.</p>\n</div>","id":"stellargo","irc":null,"linkedin":"sumit-sarin","name":"Sumit Sarin","slug":"/blog/authors/stellargo/","twitter":null}]}},"pageContext":{"id":"7a744457-8457-529e-9c68-1e00d5e790df"}},
    "staticQueryHashes": ["1271460761","3649515864"]}